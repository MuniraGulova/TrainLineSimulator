# TrainLineSimulator

## Задание
1. Взять одну из железнодорожных веток Таджикистана (например: Душанбе–Пахтаабад, Душанбе–Куляб или маршруты в районе Худжанда).
2. Написать программу на C++, которая выполняет следующие условия:
   - Каждый поезд — это отдельный поток с уникальным номером. Минимум 8 поездов.
   - Поезда движутся по заданным маршрутам, состоящим из станций.
   - Станция — общий ресурс: одновременно на ней может находиться только один поезд.
   - Все события (прибытие, отправление, движение) логируются с текущим временем.
   - Проезд между станциями не мгновенный — используется задержка.
3. Работа и устройство программы должны быть чётко описаны в GitHub.

---

# Описание проекта
Данный проект моделирует движение поездов по реальным железнодорожным веткам Таджикистана с использованием многопоточности в C++.
Цель — показать, как независимые «поезда-потоки» двигаются по сети станций, корректно деля общий ресурс(станцию) без одновременного заезда двух поездов на одну точку.
В качестве примера взяты южные линии Таджикистана:
- Душанбе – Вахдат – Ёвон – Бохтар – Куляб  
- Ответвление на Шаартуз  
- Ответвление на Колхозобод

---

## Маршруты
Маршрут — это последовательность сегментов:
```
откуда → куда → время_в_секундах
```
Каждый `Line` содержит:
- `from` — станция отправления  
- `to` — станция прибытия  
- `travelTime` — время пути  
В проекте определены три базовых маршрута:
1. Душанбе → Вахдат → Ёвон → Бохтар → Куляб  
2. Душанбе → Вахдат → Ёвон → Бохтар → Шаартуз  
3. Душанбе → Вахдат → Ёвон → Бохтар → Колхозобод  
Пример лога старта:
```
Train 1 STARTED: Dushanbe->Kulob
Train 5 STARTED: Dushanbe->Shaartuz
Train 3 STARTED: Dushanbe->Kolkhozobod
```

---

## Станции как общий ресурс
Каждая станция имеет собственный `mutex`.  
Когда поезд пытается заехать на станцию:
1. Он блокирует её мьютекс (если станция занята — ждёт).  
2. Логирует прибытие.  
3. Стоит короткую задержку.  
4. Разблокирует мьютекс.
Пример:
```
[21:10:55] Train 3 ARRIVED at Vahdat
[21:10:57] Train 1 ARRIVED at Vahdat
[21:10:59] Train 5 ARRIVED at Vahdat
```
Три поезда занимают Вахдат по очереди.

---

## Поезда как потоки
Каждый поезд — отдельный `std::thread`.
Для каждого сегмента маршрута поток:
1. Логирует движение  
```
[21:10:53] Train 1 travelling Dushanbe -> Vahdat
```
2. «Едет» (sleep).  
3. Захватывает станцию.  
4. Логирует прибытие и отправление:
```
[21:10:57] Train 1 ARRIVED at Vahdat
[21:10:58] Train 1 LEFT Vahdat
```

Финиш:
```
[21:11:17] Train 5 FINISHEd route
```

---

## Формирование разных поездов
Программа создаёт 9 поездов. Чтобы маршруты были разнообразными:
- каждому поезду назначается один из трёх маршрутов;
- маршрут случайно сдвигается, чтобы стартовая станция менялась;
- каждый второй поезд едет в обратную сторону;
- включена защита от маршрутов вида `A → A` при rotate .
Пример:

Поезда в прямом направлении:
```
Train 1 STARTED: Dushanbe->Kulob
Train 5 STARTED: Dushanbe->Shaartuz
Train 3 STARTED: Dushanbe->Kolkhozobod
```

Поезда в обратном направлении:
```
Train 4 STARTED: Kulob->Dushanbe
Train 2 STARTED: Shaartuz->Dushanbe
Train 6 STARTED: Kolkhozobod->Dushanbe
```

---

# Пример работы симуляции

### Старт потоков
```
[21:10:52] Train 1 STARTED: Dushanbe->Kulob
[21:10:52] Train 2 STARTED: Shaartuz->Dushanbe
...

```

### Параллельное движение
```
[21:10:53] Train 1 travelling Dushanbe -> Vahdat
[21:10:53] Train 3 travelling Dushanbe -> Vahdat
[21:10:53] Train 7 travelling Dushanbe -> Vahdat
```

### Очередь на станции
```
[21:10:55] Train 3 ARRIVED at Vahdat
[21:10:57] Train 7 ARRIVED at Vahdat
[21:10:59] Train 9 ARRIVED at Vahdat
```

### Завершение маршрутов
```
[21:11:08] Train 3 FINISHEd route
[21:11:13] Train 1 FINISHEd route
```

### Финал
```
----> Simulation OFF,the end ^_^! <----=
```
